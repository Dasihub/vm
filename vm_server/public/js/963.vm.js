"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[963],{1028:(e,s,a)=>{a.r(s),a.d(s,{default:()=>v});var l=a(5893),i=a(7294),t=a(5248),n=a(7026),c=a(927),d=a(9948),u=a(3319);const r="_WaUejHbB3qj_okgATCs";var o=function(e,s,a,l){return new(a||(a=Promise))((function(i,t){function n(e){try{d(l.next(e))}catch(e){t(e)}}function c(e){try{d(l.throw(e))}catch(e){t(e)}}function d(e){var s;e.done?i(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(n,c)}d((l=l.apply(e,s||[])).next())}))};const v=()=>{const{request:e}=(0,c.i)(),{ws:s}=(0,n.X)((e=>e.wsReducer)),{lang:a}=(0,n.X)((e=>e.langReducer)),{years:v}=(0,n.X)((e=>e.yearReducer)),{id_group:b}=(0,n.X)((e=>e.userInfoReducer)),{id_user:g}=(0,n.X)((e=>e.authReducer)),[j,_]=i.useState([]),[h,p]=i.useState(),[m,O]=i.useState([]),[f,$]=i.useState([]),[x,y]=i.useState([]),[w,C]=i.useState(),[S,N]=i.useState(),[k,D]=i.useState({discipline:!1,semester:!1,teacher:!1,journal:!1}),[U,E]=i.useState({v_year:{value:null,label:""},v_semester:{value:null,label:""},v_teacher:{value:null,label:""}}),[R,X]=i.useState({value:null,label:""}),q=(0,d.t)(x,"short_name"),A=(s,l)=>o(void 0,void 0,void 0,(function*(){D(Object.assign(Object.assign({},k),{discipline:!0}));const{data:i}=yield e(`/student/discipline/?id_year=${l}&id_ws=${s}&id_group=${b}&id_student=${g}&lang=${a}`),t=i.map(((e,s)=>Object.assign(Object.assign({},e),{num:s})));_(t),D(Object.assign(Object.assign({},k),{discipline:!1}))}));i.useEffect((()=>{if(v.length){const{id_a_year:e,p32:a}=v.find((e=>1==e.defaultValue));if(E(Object.assign(Object.assign({},U),{v_year:{value:e,label:a}})),s.length){const{id_ws:a,ws:l}=s.find((e=>1==e.defaultValue));X({value:a,label:l}),A(a,e)}}}),[v,s]);const{v_year:B,v_semester:H,v_teacher:T}=U;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",Object.assign({className:"box_container"},{children:[(0,l.jsxs)("div",Object.assign({className:r},{children:[(0,l.jsx)("div",Object.assign({className:"w-100"},{children:(0,l.jsx)(t.uU,{placeholder:"Учебный год",label:"Учебный год",value:B,options:v.map((e=>({value:e.id_a_year,label:e.p32}))),onChange:e=>{E(Object.assign(Object.assign({},U),{v_year:e,v_semester:{value:null,label:""},v_teacher:{value:null,label:""}})),X({value:null,label:""}),p(void 0),x.length&&y([])}})})),(0,l.jsx)("div",Object.assign({className:"w-100"},{children:(0,l.jsx)(t.uU,{placeholder:"Полугодие",label:"Полугодие",value:R.value?R:"",options:s.map((e=>({value:e.id_ws,label:e.ws}))),onChange:e=>{E(Object.assign(Object.assign({},U),{v_semester:{value:null,label:""},v_teacher:{value:null,label:""}})),X(e),p(void 0),j.length&&_([]),A(e.value,U.v_year.value),m.length&&O([]),f.length&&$([]),x.length&&y([])},isDisabled:!B.value})})),(0,l.jsx)("div",Object.assign({className:"w-100"},{children:(0,l.jsx)(t.uU,{placeholder:"Дисциплина",label:"Дисциплина",value:(null==h?void 0:h.id_discipline)?{value:null==h?void 0:h.num,label:null==h?void 0:h.discipline}:"",options:j.map((e=>({value:e.num,label:e.discipline}))),loader:k.discipline,onChange:s=>{const l=j.find((e=>e.num==s.value));var i;p(l),m.length&&O([]),i=null==l?void 0:l.id_discipline,o(void 0,void 0,void 0,(function*(){D(Object.assign(Object.assign({},k),{semester:!0}));const{data:s}=yield e(`/student/semester/?id_year=${B.value}&id_ws=${R.value}&id_group=${b}&id_student=${g}&id_discipline=${i}&lang=${a}`);O(s),D(Object.assign(Object.assign({},k),{semester:!1}))})),f.length&&$([]),x.length&&y([])},isDisabled:!R.value})}))]})),(0,l.jsxs)("div",Object.assign({className:"_WaUejHbB3qj_okgATCs mt-2"},{children:[(0,l.jsx)("div",Object.assign({className:"w-100"},{children:(0,l.jsx)(t.uU,{placeholder:"Семестр",label:"Семестр",value:H.value?H:"",options:m.map((e=>({value:e.id_semester,label:e.p43}))),loader:k.semester,onChange:s=>{var l;E(Object.assign(Object.assign({},U),{v_semester:s,v_teacher:{value:null,label:""}})),f.length&&$([]),l=s.value,o(void 0,void 0,void 0,(function*(){D(Object.assign(Object.assign({},k),{teacher:!0}));const{data:s}=yield e(`/student/teacher/?id_year=${B.value}&id_ws=${R.value}&id_group=${b}&id_student=${g}&id_discipline=${null==h?void 0:h.id_discipline}&id_semester=${l}&is_select=${null==h?void 0:h.isSelect}&lang=${a}`);$(s),D(Object.assign(Object.assign({},k),{teacher:!1}))})),x.length&&y([])},isDisabled:!(null==h?void 0:h.id_discipline)})})),(0,l.jsx)("div",Object.assign({className:"w-100"},{children:(0,l.jsx)(t.uU,{placeholder:"Преподаватель",label:"Преподаватель",value:T.value?T:"",options:f.map((e=>({value:e.id_teacher,label:e.t_fio}))),loader:k.teacher,onChange:s=>{var l;E(Object.assign(Object.assign({},U),{v_teacher:s})),l=s.value,o(void 0,void 0,void 0,(function*(){D(Object.assign(Object.assign({},k),{journal:!0}));const{data:s}=yield e(`/student/journal/?id_year=${B.value}&id_ws=${R.value}&id_group=${b}&id_student=${g}&id_discipline=${null==h?void 0:h.id_discipline}&id_semester=${H.value}&is_select=${null==h?void 0:h.isSelect}&credit=${null==h?void 0:h.credits}&id_teacher=${l}&lang=${a}`);y(s),D(Object.assign(Object.assign({},k),{journal:!1}));const i=(0,d.t)(s,"visitDate");Object.keys(i).forEach(((e,s)=>{const a=(0,d.t)(i[e],"short_name");i[e]=a,Object.keys(a).forEach(((s,a)=>{const l=(0,d.t)(i[e][s],"timesCount");i[e][s]=l}))}));let t={};Object.keys(i).forEach((e=>{t[e]=0})),s.forEach((e=>{e.timesCount>t[e.visitDate]&&(t[e.visitDate]=e.timesCount)})),C(i),N(t)}))},isDisabled:!H.value})}))]}))]})),k.journal?(0,l.jsx)("div",Object.assign({className:"_WaUejHbB3qj_okgATCs mt-2"},{children:(0,l.jsx)(t.aN,{})})):x.length?(0,l.jsx)(u.ih,{data:w,dataMax:S,visitDateGrouped:q}):(0,l.jsx)("p",Object.assign({className:"text-center mt-4"},{children:"Пока нет данных!"}))]})}}}]);